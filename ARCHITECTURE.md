# Архитектура Task Management System

## Общее описание

Task Management System - это RESTful приложение, построенное на основе Spring Boot для управления задачами. 
Система использует многоуровневую архитектуру с четким разделением ответственности между компонентами.

## Архитектурные слои

### 1. Presentation Layer (Controllers)
- Обрабатывает HTTP-запросы
- Валидирует входящие данные
- Преобразует DTO в бизнес-модели и обратно
- Обеспечивает безопасность через аннотации @PreAuthorize
- Документирует API через OpenAPI/Swagger аннотации

### 2. Business Layer (Services)
- Реализует бизнес-логику
- Управляет транзакциями
- Обеспечивает кэширование данных
- Проверяет бизнес-правила и права доступа
- Логирует важные операции

### 3. Data Access Layer (Repositories)
- Взаимодействует с базой данных
- Использует Spring Data JPA
- Определяет методы доступа к данным
- Оптимизирует запросы

### 4. Domain Layer (Models)
- Определяет бизнес-сущности
- Реализует базовую валидацию через аннотации
- Управляет связями между сущностями
- Использует Lombok для уменьшения шаблонного кода

## Основные компоненты

### Security
- JWT-based аутентификация
- Ролевая авторизация (ROLE_ADMIN, ROLE_USER)
- Защита endpoints через @PreAuthorize
- Фильтрация запросов через JwtAuthenticationFilter

### Caching
- Использование Caffeine Cache
- Кэширование пользователей и задач
- Стратегии инвалидации кэша
- Мониторинг через Actuator

### Monitoring
- Spring Boot Actuator для системных метрик
- Prometheus для сбора метрик
- Grafana для визуализации
- Логирование через SLF4J

## Потоки данных

### Создание задачи
1. Controller получает TaskRequest
2. Валидация входных данных
3. Service создает Task
4. Repository сохраняет в БД
5. Очистка кэша
6. Возврат TaskResponse

### Получение задачи
1. Controller получает ID
2. Service проверяет кэш
3. При промахе кэша - запрос к Repository
4. Проверка прав доступа
5. Возврат TaskResponse

## Безопасность

### Аутентификация
1. Пользователь отправляет credentials
2. AuthService проверяет и создает JWT
3. Токен используется для последующих запросов

### Авторизация
1. JwtAuthenticationFilter проверяет токен
2. @PreAuthorize проверяет права
3. Service дополнительно проверяет бизнес-правила

## Масштабируемость

### Кэширование
- Двухуровневое кэширование (Caffeine + потенциально Redis)
- Настраиваемые параметры кэша
- Мониторинг производительности

### База данных
- Поддержка пагинации
- Оптимизированные запросы
- Индексы для частых операций

## Мониторинг и обслуживание

### Метрики
- Системные метрики через Actuator
- Бизнес-метрики через Prometheus
- Визуализация в Grafana
- Алерты при проблемах

### Логирование
- Структурированные логи
- Различные уровни логирования
- Трассировка операций
- Аудит важных действий

## Развертывание

### Docker
- Многослойные образы
- Оптимизация размера
- Конфигурация через переменные среды

### Композиция сервисов
- База данных
- Приложение
- Prometheus
- Grafana

## Расширяемость

### Новые функции
- Модульная структура
- Чистые интерфейсы
- Документированный код
- Тестируемый дизайн

### Интеграции
- REST API
- Swagger документация
- Стандартные форматы данных
- Версионирование API 